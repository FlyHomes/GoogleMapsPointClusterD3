!function(t){function e(o){if(n[o])return n[o].exports;var r=n[o]={exports:{},id:o,loaded:!1};return t[o].call(r.exports,r,r.exports,e),r.loaded=!0,r.exports}var n={};return e.m=t,e.c=n,e.p="dist/",e(0)}([function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}var r=n(7),i=(o(r),n(1));window.PointCluster=i.PointCluster},function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0}),e.PointCluster=void 0;var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),s=n(2),a=o(s),l=n(3),u=o(l);e.PointCluster=function(){function t(e){return r(this,t),e.map?(this.map=e.map,this.clusterRange=e.clusterRange||300,this.threshold=e.threshold||200,this.clusterRgba=e.clusterRgba||"51, 102, 153, 0.8",this.clusterBorder=e.clusterBorder||"5px solid #ccc",this.polygonStrokeColor=e.polygonStrokeColor||"#336699",this.polygonStrokeOpacity=e.polygonStrokeOpacity||"0.5",this.polygonStrokeWeight=e.polygonStrokeWeight||"4",this.polygonFillColor=e.polygonFillColor||"#336699",this.polygonFillOpacity=e.polygonFillOpacity||"0.2",void this.setMapEvents()):console.error("ERROR: Google map instance is a requirement.")}return i(t,[{key:"setCollection",value:function(t){return t?void(this.collection=t):console.error("Please pass an array of location objects. Ignore if running tests.")}},{key:"createOverlay",value:function(){this.overlay&&this.overlay.setMap(null),this.overlay=new u["default"](this.map),this.overlay.setMap(this.map),window.overlay=this.overlay}},{key:"print",value:function(){var t=this,e=d3.geo.mercator(),n=(d3.geo.path().projection(e).pointRadius(1),d3.geom.quadtree()(this.returnPointsRaw())),o=this.getCenterPoints(n);this.createOverlay();var r=setInterval(function(){document.getElementById("point_cluster_overlay")&&(clearInterval(r),t.paintPinsToCanvas(o))},10)}},{key:"paintPinsToCanvas",value:function(t){var e=this,n=document.createDocumentFragment();t.forEach(function(t,o){var r,i,s=t[2].length;s.toString().length>=3?(r="large",i=25):2==s.toString().length?(r="medium",i=20):(r="small",i=15);var a=document.createElement("div");a.className="point-cluster "+r,a.style.left=t[0]-i+"px",a.style.top=t[1]-i+"px",a.style.backgroundColor="rgba("+e.clusterRgba+")",a.style.border=e.clusterBorder,a.dataset.positionid=o;var l=[];t[2].forEach(function(t,e){l.push(t[2])}),a.dataset.latlngids=l.join(","),a.innerHTML=s,n.appendChild(a),e.setClusterEvents(a)}),document.getElementById("point_cluster_overlay").appendChild(n)}},{key:"setClusterEvents",value:function(t){var e=this;t.onmouseover=function(){e.showPolygon(this)},t.onmouseout=function(){e.removePolygon()},t.onclick=function(){e.removeElements(),e.removePolygon(),e.zoomToFit(this)}}},{key:"setMapEvents",value:function(){var t=this;google.maps.event.addListener(this.map,"idle",function(){t.collection&&t.print()})}},{key:"zoomToFit",value:function(t){var e=this,n=t.dataset.latlngids.split(","),o=[];n.forEach(function(t,n){var r=e.collection[parseInt(t)];o.push(new google.maps.LatLng(r.lat,r.lng))});for(var r=new google.maps.LatLngBounds,i=0;i<o.length;i++)r.extend(o[i]);this.map.fitBounds(r)}},{key:"returnPointsRaw",value:function(){var t=this.map.getProjection(),e=t.fromLatLngToPoint(this.map.getBounds().getNorthEast()),n=t.fromLatLngToPoint(this.map.getBounds().getSouthWest()),o=Math.pow(2,this.map.getZoom());return this.collection.map(function(r,i){var s=t.fromLatLngToPoint(new google.maps.LatLng(r.lat,r.lng)),a=(s.x-n.x)*o,l=(s.y-e.y)*o;return[a,l,i]})}},{key:"searchQuadTree",value:function(t,e,n,o,r){var i=[];return t.visit(function(t,s,a,l,u){var c=t.point;return c&&(c.selected=c[0]>=e&&c[0]<o&&c[1]>=n&&c[1]<r,c.selected&&i.push(c)),s>=o||a>=r||e>l||n>u}),i}},{key:"getCenterPoints",value:function(t){for(var e=[],n=0;n<=document.getElementById("map").offsetWidth;n+=this.clusterRange)for(var o=0;o<=document.getElementById("map").offsetHeight;o+=this.clusterRange){var r=this.searchQuadTree(t,n,o,n+this.clusterRange,o+this.clusterRange),i=r.reduce(function(t,e){return[t[0]+e[0],t[1]+e[1]]},[0,0]);i[0]=i[0]/r.length,i[1]=i[1]/r.length,i.push(r),i[0]&&i[1]&&e.push(i)}return e}},{key:"removeElements",value:function(){for(var t=document.getElementsByClassName("point-cluster");t.length>0;)t[0].parentNode.removeChild(t[0])}},{key:"showPolygon",value:function(t){var e=this,n=t.dataset.latlngids.split(",");n.push(n[0]);var o=[];n.forEach(function(t,n){var r=e.collection[parseInt(t)];o.push({x:r.lat,y:r.lng})});var o=(0,a["default"])(o);o=o.map(function(t){return{lat:t.x,lng:t.y}}),this.polygon=new google.maps.Polygon({paths:o,strokeColor:e.polygonStrokeColor,strokeOpacity:e.polygonStrokeOpacity,strokeWeight:e.polygonStrokeWeight,fillColor:e.polygonFillColor,fillOpacity:e.polygonFillOpacity}),this.polygon.setMap(e.map)}},{key:"removePolygon",value:function(){return void 0===this.polygon?!1:void this.polygon.setMap(null)}}]),t}()},function(t,e,n){var o;!function(){"use strict";function r(t){t.sort(function(t,e){return t.x!=e.x?t.x-e.x:t.y-e.y});for(var e=t.length,n=[],o=0;2*e>o;o++){for(var r=e>o?o:2*e-1-o;n.length>=2&&i(n[n.length-2],n[n.length-1],t[r]);)n.pop();n.push(t[r])}return n.pop(),n}function i(t,e,n){var o=(t.x-e.x)*(n.y-e.y)-(t.y-e.y)*(n.x-e.x),r=(t.x-e.x)*(n.x-e.x)+(t.y-e.y)*(n.y-e.y);return 0>o||0==o&&0>=r}o=function(){return r}.call(e,n,e,t),!(void 0!==o&&(t.exports=o))}()},function(t,e){"use strict";function n(t){this.map=t}n.prototype=new google.maps.OverlayView,n.prototype.onRemove=function(){this.div.parentNode.removeChild(this.div),this.div=null},n.prototype.onAdd=function(){this.div=document.createElement("div"),this.div.id="point_cluster_overlay";var t=this.getPanes();t.overlayImage.appendChild(this.div)},n.prototype.draw=function(){var t=this.getProjection(),e=t.fromLatLngToDivPixel(this.map.getBounds().getSouthWest()),n=t.fromLatLngToDivPixel(this.map.getBounds().getNorthEast());this.div.style.left=e.x+"px",this.div.style.top=n.y+"px"},t.exports=n},function(t,e,n){e=t.exports=n(5)(),e.push([t.id,".point-cluster{position:absolute;color:#fff;z-index:2000;font-family:Helvetica,Verdana,Arial,sans-serif;width:50px;height:50px;text-align:center;font-size:11px;cursor:pointer}.point-cluster.large{width:50px;height:50px;line-height:50px;border-radius:50px}.point-cluster.medium{width:40px;height:40px;line-height:40px;border-radius:40px}.point-cluster.small{width:30px;height:30px;line-height:30px;border-radius:30px}#point_cluster_overlay{position:absolute}",""])},function(t,e){t.exports=function(){var t=[];return t.toString=function(){for(var t=[],e=0;e<this.length;e++){var n=this[e];n[2]?t.push("@media "+n[2]+"{"+n[1]+"}"):t.push(n[1])}return t.join("")},t.i=function(e,n){"string"==typeof e&&(e=[[null,e,""]]);for(var o={},r=0;r<this.length;r++){var i=this[r][0];"number"==typeof i&&(o[i]=!0)}for(r=0;r<e.length;r++){var s=e[r];"number"==typeof s[0]&&o[s[0]]||(n&&!s[2]?s[2]=n:n&&(s[2]="("+s[2]+") and ("+n+")"),t.push(s))}},t}},function(t,e,n){function o(t,e){for(var n=0;n<t.length;n++){var o=t[n],r=h[o.id];if(r){r.refs++;for(var i=0;i<r.parts.length;i++)r.parts[i](o.parts[i]);for(;i<o.parts.length;i++)r.parts.push(u(o.parts[i],e))}else{for(var s=[],i=0;i<o.parts.length;i++)s.push(u(o.parts[i],e));h[o.id]={id:o.id,refs:1,parts:s}}}}function r(t){for(var e=[],n={},o=0;o<t.length;o++){var r=t[o],i=r[0],s=r[1],a=r[2],l=r[3],u={css:s,media:a,sourceMap:l};n[i]?n[i].parts.push(u):e.push(n[i]={id:i,parts:[u]})}return e}function i(t,e){var n=v(),o=x[x.length-1];if("top"===t.insertAt)o?o.nextSibling?n.insertBefore(e,o.nextSibling):n.appendChild(e):n.insertBefore(e,n.firstChild),x.push(e);else{if("bottom"!==t.insertAt)throw new Error("Invalid value for parameter 'insertAt'. Must be 'top' or 'bottom'.");n.appendChild(e)}}function s(t){t.parentNode.removeChild(t);var e=x.indexOf(t);e>=0&&x.splice(e,1)}function a(t){var e=document.createElement("style");return e.type="text/css",i(t,e),e}function l(t){var e=document.createElement("link");return e.rel="stylesheet",i(t,e),e}function u(t,e){var n,o,r;if(e.singleton){var i=m++;n=y||(y=a(e)),o=c.bind(null,n,i,!1),r=c.bind(null,n,i,!0)}else t.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(n=l(e),o=f.bind(null,n),r=function(){s(n),n.href&&URL.revokeObjectURL(n.href)}):(n=a(e),o=p.bind(null,n),r=function(){s(n)});return o(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;o(t=e)}else r()}}function c(t,e,n,o){var r=n?"":o.css;if(t.styleSheet)t.styleSheet.cssText=b(e,r);else{var i=document.createTextNode(r),s=t.childNodes;s[e]&&t.removeChild(s[e]),s.length?t.insertBefore(i,s[e]):t.appendChild(i)}}function p(t,e){var n=e.css,o=e.media;e.sourceMap;if(o&&t.setAttribute("media",o),t.styleSheet)t.styleSheet.cssText=n;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(n))}}function f(t,e){var n=e.css,o=(e.media,e.sourceMap);o&&(n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(o))))+" */");var r=new Blob([n],{type:"text/css"}),i=t.href;t.href=URL.createObjectURL(r),i&&URL.revokeObjectURL(i)}var h={},d=function(t){var e;return function(){return"undefined"==typeof e&&(e=t.apply(this,arguments)),e}},g=d(function(){return/msie [6-9]\b/.test(window.navigator.userAgent.toLowerCase())}),v=d(function(){return document.head||document.getElementsByTagName("head")[0]}),y=null,m=0,x=[];t.exports=function(t,e){e=e||{},"undefined"==typeof e.singleton&&(e.singleton=g()),"undefined"==typeof e.insertAt&&(e.insertAt="bottom");var n=r(t);return o(n,e),function(t){for(var i=[],s=0;s<n.length;s++){var a=n[s],l=h[a.id];l.refs--,i.push(l)}if(t){var u=r(t);o(u,e)}for(var s=0;s<i.length;s++){var l=i[s];if(0===l.refs){for(var c=0;c<l.parts.length;c++)l.parts[c]();delete h[l.id]}}}};var b=function(){var t=[];return function(e,n){return t[e]=n,t.filter(Boolean).join("\n")}}()},function(t,e,n){var o=n(4);"string"==typeof o&&(o=[[t.id,o,""]]);n(6)(o,{});o.locals&&(t.exports=o.locals)}]);